/*! zui - v1.0.0 - 2015-10-30 */!function() {
    function a(a, b, c) {
        var d = b && c || 0, e = 0;
        for (b = b || [], a.toLowerCase().replace(/[0-9a-f]{2}/g, function(a) {
            16 > e && (b[d + e++] = j[a]);
        }); 16 > e; ) b[d + e++] = 0;
        return b;
    }
    function b(a, b) {
        var c = b || 0, d = i;
        return d[a[c++]] + d[a[c++]] + d[a[c++]] + d[a[c++]] + "-" + d[a[c++]] + d[a[c++]] + "-" + d[a[c++]] + d[a[c++]] + "-" + d[a[c++]] + d[a[c++]] + "-" + d[a[c++]] + d[a[c++]] + d[a[c++]] + d[a[c++]] + d[a[c++]] + d[a[c++]];
    }
    function c(a, c, d) {
        var e = c && d || 0, f = c || [];
        a = a || {};
        var g = null != a.clockseq ? a.clockseq : n, h = null != a.msecs ? a.msecs : new Date().getTime(), i = null != a.nsecs ? a.nsecs : p + 1, j = h - o + (i - p) / 1e4;
        if (0 > j && null == a.clockseq && (g = g + 1 & 16383), (0 > j || h > o) && null == a.nsecs && (i = 0), 
        i >= 1e4) throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");
        o = h, p = i, n = g, h += 122192928e5;
        var k = (1e4 * (268435455 & h) + i) % 4294967296;
        f[e++] = k >>> 24 & 255, f[e++] = k >>> 16 & 255, f[e++] = k >>> 8 & 255, f[e++] = 255 & k;
        var l = h / 4294967296 * 1e4 & 268435455;
        f[e++] = l >>> 8 & 255, f[e++] = 255 & l, f[e++] = l >>> 24 & 15 | 16, f[e++] = l >>> 16 & 255, 
        f[e++] = g >>> 8 | 128, f[e++] = 255 & g;
        for (var q = a.node || m, r = 0; 6 > r; r++) f[e + r] = q[r];
        return c ? c : b(f);
    }
    function d(a, c, d) {
        var f = c && d || 0;
        "string" == typeof a && (c = "binary" == a ? new h(16) : null, a = null), a = a || {};
        var g = a.random || (a.rng || e)();
        if (g[6] = 15 & g[6] | 64, g[8] = 63 & g[8] | 128, c) for (var i = 0; 16 > i; i++) c[f + i] = g[i];
        return c || b(g);
    }
    var e, f = this;
    if (!e) {
        var g = new Array(16);
        e = function() {
            for (var a, b = 0; 16 > b; b++) 0 === (3 & b) && (a = 4294967296 * Math.random()), 
            g[b] = a >>> ((3 & b) << 3) & 255;
            return g;
        };
    }
    for (var h = Array, i = [], j = {}, k = 0; 256 > k; k++) i[k] = (k + 256).toString(16).substr(1), 
    j[i[k]] = k;
    var l = e(), m = [ 1 | l[0], l[1], l[2], l[3], l[4], l[5] ], n = 16383 & (l[6] << 8 | l[7]), o = 0, p = 0, q = d;
    q.v1 = c, q.v4 = d, q.parse = a, q.unparse = b, q.BufferClass = h;
    var r = function() {};
    r.extend = function(a, b) {
        var c = r.prototype.extend;
        r._prototyping = !0;
        var d = new this();
        c.call(d, a), d.base = function() {}, delete r._prototyping;
        var e = d.constructor, f = d.constructor = function() {
            if (!r._prototyping) if (this._constructing || this.constructor == f) this._constructing = !0, 
            e.apply(this, arguments), delete this._constructing; else if (null != arguments[0]) return (arguments[0].extend || c).call(arguments[0], d);
        };
        return f.ancestor = this, f.extend = this.extend, f.forEach = this.forEach, f.implement = this.implement, 
        f.prototype = d, f.toString = this.toString, f.valueOf = function(a) {
            return "object" == a ? f : e.valueOf();
        }, c.call(f, b), "function" == typeof f.init && f.init(), f;
    }, r.prototype = {
        extend: function(a, b) {
            if (arguments.length > 1) {
                var c = this[a];
                if (c && "function" == typeof b && (!c.valueOf || c.valueOf() != b.valueOf()) && /\bbase\b/.test(b)) {
                    var d = b.valueOf();
                    b = function() {
                        var a = this.base || r.prototype.base;
                        this.base = c;
                        var b = d.apply(this, arguments);
                        return this.base = a, b;
                    }, b.valueOf = function(a) {
                        return "object" == a ? b : d;
                    }, b.toString = r.toString;
                }
                this[a] = b;
            } else if (a) {
                var e = r.prototype.extend;
                r._prototyping || "function" == typeof this || (e = this.extend || e);
                for (var f = {
                    toSource: null
                }, g = [ "constructor", "toString", "valueOf" ], h = r._prototyping ? 0 : 1; i = g[h++]; ) a[i] != f[i] && e.call(this, i, a[i]);
                for (var i in a) f[i] || e.call(this, i, a[i]);
            }
            return this;
        }
    }, r = r.extend({
        constructor: function() {
            this.extend(arguments[0]);
        }
    }, {
        ancestor: Object,
        version: "1.1",
        forEach: function(a, b, c) {
            for (var d in a) void 0 === this.prototype[d] && b.call(c, a[d], d, a);
        },
        implement: function() {
            for (var a = 0; a < arguments.length; a++) "function" == typeof arguments[a] ? arguments[a](this.prototype) : this.prototype.extend(arguments[a]);
            return this;
        },
        toString: function() {
            return String(this.valueOf());
        }
    });
    var s = r.extend({
        constructor: function(a, b) {
            if (this.context = a, this.title = b.title || "", void 0 != b.backButton && "function" != typeof b.backButton) throw new Error("backButton should be a function!");
            this.backButton = b.backButton, this.pageId = "page-" + q.v4().substr(0, 8), this.$el = $("#" + this.pageId), 
            this.template = b.template, this.model = b.model, this.transition = b.transition || "slide", 
            this.ready = b.ready;
        },
        _renderNavBar: function() {
            $(".ui-nav").empty().remove();
            var a, b = '<div class="ui-nav">';
            if ("function" == typeof this.backButton && (a = "btn-back-" + q.v4().substr(0, 8), 
            b += '<button id="' + a + '" class="ui-btn"><i class="ui-icon ui-icon-angle-left"></i> </button>'), 
            b += '<div class="title">' + this.title + "</div></div>", $("body>.ui-nav:eq(0)").empty().remove(), 
            $("body").prepend(b), "function" != typeof this.backButton) return !1;
            var c = this;
            $("#" + a).on("click", function(a) {
                c.backButton(a);
            });
        },
        render: function() {
            return this._renderNavBar(), this._renderPage(), this;
        },
        _renderPage: function() {
            var a = $("body>.ui-page");
            a.size() > 0 && (a.fadeOut(500), _.delay(function() {
                a.empty().remove();
            }, 500)), $("body").append('<div class="ui-page" id="' + this.pageId + '"></div>'), 
            $("#" + this.pageId).html(_.template(this.template)(this.model)), "function" == typeof this.ready && this.ready();
        },
        refresh: function() {
            return $("#" + this.pageId).empty(), this._renderPage(), this;
        }
    }), t = 10, u = r.extend({
        constructor: function(a) {
            this.routes = a.routes, this.defaultRoute = a.defaultRoute;
        },
        GET: function() {
            var a = {}, b = location.href.split("?");
            if (b.length > 1) for (var c = b[1].split("&"), d = 0; d < c.length; d++) {
                var e = c[d].split("=");
                a[e[0]] = e[1];
            }
            return a;
        }(),
        history: [],
        navigate: function(a, b) {
            if (!this.routes[a]) throw new Error("Undefined Route");
            this.clearTimers(), this.routes[a](b);
            var c = this.history;
            c.length > t && c.splice(0, 1), c.push({
                route: a,
                params: b || {}
            });
        },
        start: function(a) {
            this.navigate(this.defaultRoute, a);
        },
        back: function() {
            if (this.history.length >= 2) {
                this.clearTimers(), this.history.pop();
                var a = _.last(this.history);
                this.navigate(a.route, a.params);
            }
        },
        timers: [],
        addTimer: function(a, b) {
            var c = this.timers;
            c.push({
                key: a,
                tid: b
            });
        },
        deleteTimers: function(a) {
            var b = this.timers;
            _.each(b, function(b, c) {
                b.key == a && clearInterval(b.tid);
            }), b = _.filter(b, function(b) {
                return b.key != a;
            });
        },
        clearTimers: function() {
            return 0 == this.timers.length ? !1 : (_.each(this.timers, function(a) {
                clearInterval(a.tid);
            }), void (this.timers = []));
        },
        hasTimer: function(a) {
            return _.find(timers, function(b) {
                return b.key == a;
            });
        }
    }), v = {
        Engine: function(a) {
            return new u(a);
        },
        Page: function(a) {
            return new s(a);
        }
    };
    f.zui = v;
}();