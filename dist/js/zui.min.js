/*! zui - v0.1.0 -  *2015-11-05 by Wangdahoo */!function(){function a(a,b,c){var d=b&&c||0,e=0;for(b=b||[],a.toLowerCase().replace(/[0-9a-f]{2}/g,function(a){16>e&&(b[d+e++]=p[a])});16>e;)b[d+e++]=0;return b}function b(a,b){var c=b||0,d=o;return d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]}function c(a,c,d){var e=c&&d||0,f=c||[];a=a||{};var g=null!=a.clockseq?a.clockseq:t,h=null!=a.msecs?a.msecs:(new Date).getTime(),i=null!=a.nsecs?a.nsecs:v+1,j=h-u+(i-v)/1e4;if(0>j&&null==a.clockseq&&(g=g+1&16383),(0>j||h>u)&&null==a.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=h,v=i,t=g,h+=122192928e5;var k=(1e4*(268435455&h)+i)%4294967296;f[e++]=k>>>24&255,f[e++]=k>>>16&255,f[e++]=k>>>8&255,f[e++]=255&k;var l=h/4294967296*1e4&268435455;f[e++]=l>>>8&255,f[e++]=255&l,f[e++]=l>>>24&15|16,f[e++]=l>>>16&255,f[e++]=g>>>8|128,f[e++]=255&g;for(var m=a.node||s,n=0;6>n;n++)f[e+n]=m[n];return c?c:b(f)}function d(a,c,d){var e=c&&d||0;"string"==typeof a&&(c="binary"==a?new n(16):null,a=null),a=a||{};var f=a.random||(a.rng||k)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,c)for(var g=0;16>g;g++)c[e+g]=f[g];return c||b(f)}function e(){this.id="",this.duration=1500,this.max=18e4}function f(){this.id=""}function g(){this.id=""}function h(){function a(a){return a in e?e[a]:null}function b(a,b){return e[a]=b,!0}function c(a){var b=a in e;return b?delete e[a]:!1}function d(){return e={},!0}var e={};return{getItem:a,setItem:b,removeItem:c,clear:d}}function i(){function a(){window.addEventListener?window.addEventListener("storage",b,!1):window.attachEvent?window.attachEvent("onstorage",b):window.onstorage=b}function b(a){function b(b){b(JSON.parse(a.newValue),JSON.parse(a.oldValue),a.url||a.uri)}a||(a=window.event);var c=e[a.key];c&&c.forEach(b)}function c(b,c){e[b]?e[b].push(c):e[b]=[c],f===!1&&a()}function d(a,b){var c=e[a];c.length>1?c.splice(c.indexOf(b),1):e[a]=[]}var e={},f=!1;return{on:c,off:d}}function j(){function a(a,d){return 1===arguments.length?b(a):c(a,d)}function b(a){return JSON.parse(j.getItem(a))}function c(a,b){try{return j.setItem(a,JSON.stringify(b)),!0}catch(c){return!1}}function d(a){return j.removeItem(a)}function e(){return j.clear()}var f=h(),g=i(),j="localStorage"in window&&window.localStorage?window.localStorage:f;return a.set=c,a.get=b,a.remove=d,a.clear=e,a.on=g.on,a.off=g.off,a}var k,l=this;if(!k){var m=new Array(16);k=function(){for(var a,b=0;16>b;b++)0===(3&b)&&(a=4294967296*Math.random()),m[b]=a>>>((3&b)<<3)&255;return m}}for(var n=Array,o=[],p={},q=0;256>q;q++)o[q]=(q+256).toString(16).substr(1),p[o[q]]=q;var r=k(),s=[1|r[0],r[1],r[2],r[3],r[4],r[5]],t=16383&(r[6]<<8|r[7]),u=0,v=0,w=d;w.v1=c,w.v4=d,w.parse=a,w.unparse=b,w.BufferClass=n;var x=function(){};x.extend=function(a,b){var c=x.prototype.extend;x._prototyping=!0;var d=new this;c.call(d,a),d.base=function(){},delete x._prototyping;var e=d.constructor,f=d.constructor=function(){if(!x._prototyping)if(this._constructing||this.constructor==f)this._constructing=!0,e.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||c).call(arguments[0],d)};return f.ancestor=this,f.extend=this.extend,f.forEach=this.forEach,f.implement=this.implement,f.prototype=d,f.toString=this.toString,f.valueOf=function(a){return"object"==a?f:e.valueOf()},c.call(f,b),"function"==typeof f.init&&f.init(),f},x.prototype={extend:function(a,b){if(arguments.length>1){var c=this[a];if(c&&"function"==typeof b&&(!c.valueOf||c.valueOf()!=b.valueOf())&&/\bbase\b/.test(b)){var d=b.valueOf();b=function(){var a=this.base||x.prototype.base;this.base=c;var b=d.apply(this,arguments);return this.base=a,b},b.valueOf=function(a){return"object"==a?b:d},b.toString=x.toString}this[a]=b}else if(a){var e=x.prototype.extend;x._prototyping||"function"==typeof this||(e=this.extend||e);for(var f={toSource:null},g=["constructor","toString","valueOf"],h=x._prototyping?0:1;i=g[h++];)a[i]!=f[i]&&e.call(this,i,a[i]);for(var i in a)f[i]||e.call(this,i,a[i])}return this}},x=x.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(a,b,c){for(var d in a)void 0===this.prototype[d]&&b.call(c,a[d],d,a)},implement:function(){for(var a=0;a<arguments.length;a++)"function"==typeof arguments[a]?arguments[a](this.prototype):this.prototype.extend(arguments[a]);return this},toString:function(){return String(this.valueOf())}});var y={},z=x.extend({constructor:function(a){if(this.title=a.title||"",void 0!=a.backButton&&"function"!=typeof a.backButton)throw new Error("backButton should be a function!");this.backButton=a.backButton,this.theme=a.theme||y.pageTheme,this.pageId="page-"+w.v4().substr(0,8),this.$el=$("#"+this.pageId),this.template=a.template,this.model=a.model||{},this.transition=a.transition||"forward",a.init&&"function"==typeof a.init&&(this.init=a.init),a.prepare&&"function"==typeof a.prepare&&(this.prepare=a.prepare),a.ready&&"function"==typeof a.ready&&(this.ready=a.ready),this.hideNavBar=!(void 0==a.hideNavBar),this.init()},init:function(){},prepare:!1,ready:function(){},render:function(a){var b=this,c=$("body"),d="page-fade-in",e="page-fade-out",f=400;"default"==y.pageTransition?(d="page-fade-in",e="page-fade-out"):"ios"==y.pageTransition&&("forward"==a&&(d="page-from-right-to-center",e="page-from-center-to-left"),"back"==a&&(d="page-from-left-to-center",e="page-from-center-to-right")),c.find(".ui-page").removeClass("page-from-right-to-center").removeClass("page-from-left-to-center");var g="",h="";if(this.hideNavBar)h=" full-screen";else{g='<div class="ui-nav '+("string"==typeof this.theme?"ui-nav-"+this.theme:"")+'">';var i;"function"==typeof this.backButton&&(i="btn-back-"+w.v4().substr(0,8),g+='<button id="'+i+'" class="ui-btn"><i class="ui-icon ui-icon-angle-left"></i> </button>'),g+='<div class="title">'+this.title+"</div></div>"}if(this.prepare)c.append(g+'<div class="ui-page'+h+'" id="'+b.pageId+'"></div>');else{var j="string"==typeof this.template?this.template:this.template(this.model);c.append(g+'<div class="ui-page'+h+'" id="'+b.pageId+'">'+j+"</div>")}"function"==typeof this.backButton&&$("#"+i).on("click",function(a){b.backButton(a)}),$("body>.ui-page").size()<2&&c.prepend('<div class="ui-page'+h+'"></div>'),!this.hideNavBar&&$("body>.ui-nav").size()<2&&c.prepend('<div class="ui-nav '+("string"==typeof this.theme?"ui-nav-"+this.theme:"")+'"><div class="title"></div></div>');var k,l,m=$("body>.ui-page:eq(0)"),n=$("body>.ui-page:eq(1)");return this.hideNavBar||(k=$("body>.ui-nav:eq(0)"),l=$("body>.ui-nav:eq(1)")),m.addClass(e),n.addClass(d),this.hideNavBar||(k.find(".title, .ui-btn").addClass("page-fade-out"),l.find(".title, .ui-btn").addClass("page-fade-in")),_.delay(function(){m.empty().remove(),k&&k.empty().remove(),b.prepare?b.prepare():b.ready()},f),this},refresh:function(){var a=$("#"+this.pageId),b="string"==typeof this.template?this.template:this.template(this.model);return a.empty().append(b),this.ready(),this}}),A=x.extend({constructor:function(a){this.el=a.el,this.$el=$(a.el),this.template=option.template,this.model=a.model||{},a.ready&&"function"==typeof a.ready&&(this.ready=a.ready),a.init&&"function"==typeof a.init&&(this.init=a.init),this.init()},init:function(){},render:function(){this.$el.html(this.template(this.model)),this.ready&&this.ready()}});e.prototype.cleanup=function(){$("body .ui-modal-loading, body .ui-modal-overlay").empty().remove()},e.prototype.show=function(a){var b,c;if("string"==typeof arguments[0])b=arguments[0],c=-1==arguments[1]?this.max:this.duration;else{if("object"!=typeof arguments[0])throw new Error("Illegal Parameters");b=a.message,c=-1==a.duration?this.max:a.duration||this.duration}var d="loading-"+w.v4().substr(0,8),e='<div id="'+d+'" class="ui-modal ui-modal-loading"><div class="ui-modal-content"><div class="preload-wrapper"><div class="preload"></div></div><p>'+b+'</p></div></div><div class="ui-modal-overlay"></div>',f=this;return f.cleanup(),$("body").append(e),_.delay(function(){var a=$("#"+d);a.addClass("ui-modal-show"),_.delay(function(){a.removeClass("ui-modal-show"),_.delay(function(){f.cleanup()},300)},c+300)},50),this.id=d},e.prototype.hide=function(){var a=this;return $("#"+a.id).removeClass("ui-modal-show"),_.delay(function(){a.cleanup()},300),this.id=""};var B=new e;f.prototype.cleanup=function(){$("body .ui-modal-loading, body .ui-modal-overlay").empty().remove()},f.prototype.show=function(a,b){a=a||"",b=b||1500;var c="toast-"+w.v4().substr(0,8),d='<div id="'+c+'" class="ui-modal ui-modal-loading"><div class="ui-modal-content"><p>'+a+'</p></div></div><div class="ui-modal-overlay"></div>',e=this;e.cleanup(),$("body").append(d),_.delay(function(){var a=$("#"+c);a.addClass("ui-modal-show"),_.delay(function(){a.removeClass("ui-modal-show"),_.delay(function(){e.cleanup()},300)},b+300)},50)};var C=new f;g.prototype.cleanup=function(){$("body .ui-modal-dialog, body .ui-modal-overlay").empty().remove()},g.prototype.alert=function(a){var b,c="提示",d="assertive",e="确定",f="alert-"+w.v4().substr(0,8),g="btn-ok-"+w.v4().substr(0,8),h=function(a){$("#"+f).removeClass("ui-modal-show"),_.delay(function(){j.cleanup()},300)};if("string"==typeof arguments[0])b=arguments[0]||"";else{if("object"!=typeof arguments[0])throw new Error("Illegal Parameters");b=a.message||"",a.title&&(c=a.title),"assertive"!=a.btnOkTheme&&(d="positive"),a.btnOkText&&(e=a.btnOkText)}var i='<div id="'+f+'" class="ui-modal ui-modal-dialog"><div class="ui-modal-content"><h2>'+c+"</h2><p>"+b+'</p><button id="'+g+'" class="ui-btn ui-btn-block ui-btn-'+d+'">'+e+'</button></div></div><div class="ui-modal-overlay"></div>',j=this;return j.cleanup(),$("body").append(i),_.delay(function(){var a=$("#"+f);a.addClass("ui-modal-show")},50),$("#"+g).on("click",h),this.id=f},g.prototype.confirm=function(a){function b(a){$("#"+h).removeClass("ui-modal-show"),_.delay(function(){m.cleanup(),k.resolve(a)},300)}var c,d="提示",e="assertive",f="确定",g="取消",h="alert-"+w.v4().substr(0,8),i="btn-ok-"+w.v4().substr(0,8),j="btn-cancel-"+w.v4().substr(0,8),k=$.Deferred();if("string"==typeof arguments[0])c=arguments[0]||"";else{if("object"!=typeof arguments[0])throw new Error("Illegal Parameters");c=a.message||"",a.title&&(d=a.title),"assertive"!=a.btnOkTheme&&(e="positive"),a.btnOkText&&(f=a.btnOkText),a.btnCancelText&&(g=a.btnCancelText)}var l='<div id="'+h+'" class="ui-modal ui-modal-dialog"><div class="ui-modal-content"><h2>'+d+"</h2><p>"+c+'</p><div class="ui-flex"><div class="ui-width-1-2" style="padding-right: 5px;"><button id="'+i+'" class="ui-btn ui-btn-block ui-btn-'+e+'">'+f+'</button></div><div class="ui-width-1-2" style="padding-left: 5px;"><button id="'+j+'" class="ui-btn ui-btn-block">'+g+'</button></div></div></div></div><div class="ui-modal-overlay"></div>',m=this;return m.cleanup(),$("body").append(l),_.delay(function(){var a=$("#"+h);a.addClass("ui-modal-show")},50),$("#"+i).on("click",function(){b(!0)}),$("#"+j).on("click",function(){b(!1)}),k.promise()};var D=new g,E=j(),F=10,G={},H=x.extend({constructor:function(a){var b={pageTransition:"default",pageTheme:"light"};arguments[0]&&"object"==typeof arguments[0]&&(y=_.extend(b,a))},_isReady:!1,history:[],timers:[],init:function(a){return"ios"==y.pageTransition&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&document.querySelector("meta[name=viewport]").setAttribute("content","initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=no"),this.routes=a.routes,this.defaultRoute=a.defaultRoute,this._isReady=!0,this},GET:function(){var a={},b=location.href.split("?");if(b.length>1)for(var c=b[1].split("&"),d=0;d<c.length;d++){var e=c[d].split("=");a[e[0]]=e[1]}return a}(),navigate:function(){if(!this._isReady)throw new Error("Uninitialized Engine");var a,b,c;if(!(arguments.length>=1&&"string"==typeof arguments[0]))throw new Error("Illegal Arguments");if(a=arguments[0],!this.routes[a])throw new Error("Undefined Route");if(1==arguments.length)c="forward";else if(2==arguments.length&&"object"==typeof arguments[1])b=arguments[1];else if(2==arguments.length&&"string"==typeof arguments[1])c=arguments[1];else{if(3!=arguments.length||"object"!=typeof arguments[1]||"string"!=typeof arguments[2])throw new Error("Illegal Arguments");b=arguments[1],c=arguments[2]}this.clearTimers(),"back"!=c&&(c="forward"),G.route=a,G.params=b||{},this.routes[a].render(c);var d=this.history;return d.length>F&&d.splice(0,1),d.push({route:a,params:b||{}}),this.routes[a]},start:function(){if(!this._isReady)throw new Error("Uninitialized Engine");this.navigate(this.defaultRoute,arguments[0]||{})},back:function(){if(!this._isReady)throw new Error("Uninitialized Engine");if(this.history.length>=2){this.clearTimers(),this.history.pop();var a=_.last(this.history);this.navigate(a.route,a.params,"back")}},getCurrentRoute:function(){if(!this._isReady)throw new Error("Uninitialized Engine");return _.last(this.history)},addTimer:function(a,b){var c=this.timers;c.push({key:a,tid:b})},deleteTimers:function(a){var b=this.timers;_.each(b,function(b,c){b.key==a&&clearInterval(b.tid)}),b=_.filter(b,function(b){return b.key!=a})},clearTimers:function(){return 0==this.timers.length?!1:(_.each(this.timers,function(a){clearInterval(a.tid)}),void(this.timers=[]))},hasTimer:function(a){return _.find(timers,function(b){return b.key==a})}}),I={Settings:function(){return y},state:function(){return G.route},stateParams:function(){return G.params},getStateParam:function(a){return G.params[a]},Engine:function(a){return new H(a)},Page:function(a){return new z(a)},View:function(a){return new A(a)},storage:E,showLoading:function(a){return B.show(a)},hideLoading:function(){B.hide()},LOADING_ID:function(){return B.id},toast:function(a,b){C.show(a,b)},alert:function(a){D.alert(a)},confirm:function(a){return D.confirm(a)},DIALOG_ID:function(){return D.id}};l.zui=I}();